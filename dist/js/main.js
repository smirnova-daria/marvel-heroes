(()=>{"use strict";const t=class{constructor(t){this._root=t,this.prepareTemplate()}get root(){return this._root}get template(){return this._template}prepareTemplate(){this._template=document.createElement("div")}initTemplate(){if(this._template)return this._template.innerHTML=""}render(t){t&&(this._root=t),this.initTemplate();const{root:e,template:s}=this;e&&e.append(s)}},e=class extends t{constructor(t={},e){super(e),this._data=t}initTemplate(){if(!this._template)return;this._template.classList.add("card");let t=`<div class="card__photo"><img src="${this._data.photo}" alt="${this._data.name}"/>\n\t\t\t<div class="card__info">\n\t\t`;for(let e in this._data)"photo"!==e&&"movies"!==e&&(t+=`<p class="card__${e}">${e}: <span>${this._data[e]}</span></p>`);t+="</div></div>",this._data.movies&&(t+='<div class="card__movies"><p>Movies:</p><ul class="card__movies-list">',this._data.movies.forEach((e=>{t+=`<li data-film-name="${e}" class="card__movie-item">${e}</li>`})),t+="</ul></div>"),this._template.innerHTML=t}},s=class extends t{constructor(t,e=[]){super(t),this.createCardsObjectsList(e)}createCardsObjectsList(t){this._cards=t.map((t=>new e(t)))}get cards(){return this._cards}initTemplate(){this._template&&(this._template.classList.add("cards-list"),this.cards.forEach((t=>t.render(this._template))))}},i=({timing:t,draw:e,duration:s})=>{let i=performance.now();requestAnimationFrame((function a(r){let l=(r-i)/s;l>1&&(l=1);let o=t(l);e(o),l<1&&requestAnimationFrame(a)}))},a=document.querySelector(".main__switcher"),r=document.querySelector(".main__heroes"),l=document.querySelector(".decor1"),o=document.querySelector(".decor2");var n;(n="dbHeroes.json",fetch(n).then((t=>t.json())).catch((t=>console.log("Произошла ошибка "+t)))).then((t=>{new s(r,t).render(),((t,e)=>{if(e){const s=new Set;e.forEach((t=>{t.movies&&t.movies.forEach((t=>{s.add(t)}))}));const i=document.createElement("nav");i.classList.add("switcher");let a='<ul class="filter__list">\n\t\t\t\t\t<li data-film="all" class="filter__link">Filter\n\t\t\t\t\t<ul class="switcher__list">\n\t\t\t\t\t<li data-film="all">All films</li>';for(let t of s)a+=`<li class="switcher__link" data-film="${t}">${t}</li>`;a+="</li></ul></ul>",i.innerHTML=a,t.append(i);const r=document.createElement("div");r.classList.add("selected__movie"),t.append(r)}})(a,t),(()=>{const t=document.querySelectorAll(".card"),e=document.querySelector(".switcher"),s=document.querySelector(".selected__movie");t&&e&&e.addEventListener("click",(e=>{if("LI"!==e.target.tagName)return;const i=e.target.dataset.film;t.forEach((t=>{t.classList.remove("hide"),setTimeout((()=>{t.style.display="flex"}),300),s.textContent="",t.querySelector(`.card__movies-list li[data-film-name="${i}"]`)||"all"===i||(t.classList.add("hide"),setTimeout((()=>{t.style.display="none"}),300),s.textContent="#"+i)}))}))})()})),i({duration:5e3,timing:t=>t,draw(t){l.style.width=100*t+200+"px",l.style.height=100*t+200+"px",l.style.right=100*-(1-t)+"px"}}),i({duration:1e4,timing(t){for(let e=0,s=1;;e+=s,s/=2)if(t>=(7-4*e)/11)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(s,2)},draw(t){o.style.top=300*-(1-t)+"px"}}),(()=>{const t=document.querySelector(".back_to_top");window.addEventListener("scroll",(function(){const e=window.pageYOffset,s=document.documentElement.clientHeight;e>s&&t.classList.add("back_to_top-show"),e<s&&t.classList.remove("back_to_top-show")})),t.addEventListener("click",(function t(){window.pageYOffset>0&&(window.scrollBy(0,-80),setTimeout(t,0))}))})()})();